---
import Layout from "../layouts/Layout.astro";
import Button from "../components/Button.astro";
import HomePageHero from "../components/HomePageHero.astro";
import { Image, Picture } from "@astrojs/image/components";
import FeaturedVideoBanner from "../components/FeaturedVideoBanner.astro";
import Feature from "../components/Feature.astro";
import FeatureList from "../components/FeatureList.astro";
import EventsHome from "../components/Events/EventsHome.astro";
import CTA from "../components/CTA.astro";
import ContactAvatar from "../components/ContactAvatar.astro";
import WelcomeQuestionsImage from "../components/WelcomeQuestionsImage.astro";
import Slider from "../components/Slider.astro";
import { siteSettings } from "../lib/settings";
import { homePage } from "../lib/pages";
import { allPosts } from "../lib/posts";
import { urlFor } from "../lib/sanity";

// const hero = siteSettings.homePageHero;
// const features = allFeatures.filter(
//   (feature) =>
//     feature._id === "7b24cfd6-1805-4939-8b75-fc84189214db" ||
//     feature._id === "e712d400-586a-47b3-9489-734160ef2977"
// );

import welcomeCollage from "../assets/images/welcome-collage.png";
import avatar from "../assets/images/jessica-vaughan-lower-headshot.jpg";
import { joinNames } from "../utils/format";

const title = siteSettings.siteName;
const description = siteSettings.siteDescription;
const { hero, welcome, welcomeLinks, features, homeCta, featuredResources } =
  homePage;
const resources = featuredResources.resourceLinks;
---

<Layout meta={{ title: title, description: description }}>
  <main slot="main">
    <HomePageHero hero={hero} fallbackImg={siteSettings.image} />
    <FeaturedVideoBanner />
    <WelcomeQuestionsImage />
    <article id="welcome" class="welcome">
      <div class="content-wrapper with-sidebar">
        <div class="flow">
          <div class="frame avatar">
            <img
              src={urlFor(welcome.person.image)
                .width(300)
                .height(300)
                .auto("format")
                .url()}
              width={300}
              height={300}
              alt={joinNames(welcome.person.name)}
            />
          </div>
          <h2 class="text-step-2">{welcome.heading}</h2>
          <p>{welcome.text}</p>
          <p class="small-title">â€” {joinNames(welcome.person.name)}</p>
          <div class="meet-grid">
            {
              welcome.links.map((link) => (
                <a
                  href={
                    link.href.sectionSlug
                      ? `/${link.href.pageSlug.fullUrl}`
                      : `/${link.href.pageSlug.current}`
                  }
                  class="flow"
                >
                  <h3 class="small-title">{link.name}</h3>
                  <p class="text-step--1">{link.text}</p>
                </a>
              ))
            }
            <!-- <a href="/who-we-are/church-leadership" class="flow">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 640 512"
                width="32"
                height="32"
                fill="var(--color-primary-800)"
                ><defs
                  ><style>
                    .fa-secondary {
                      opacity: 0.4;
                    }
                  </style></defs
                ><path
                  class="fa-primary"
                  d="M320 0c13.3 0 24 10.7 24 24V48h32c13.3 0 24 10.7 24 24s-10.7 24-24 24H344v46.4L456.7 210c14.5 8.7 23.3 24.3 23.3 41.2V512H384V416c0-35.3-28.7-64-64-64s-64 28.7-64 64v96H160V251.2c0-16.9 8.8-32.5 23.3-41.2L296 142.4V96H264c-13.3 0-24-10.7-24-24s10.7-24 24-24h32V24c0-13.3 10.7-24 24-24z"
                ></path><path
                  class="fa-secondary"
                  d="M160 256L24.9 330.3C9.5 338.8 0 354.9 0 372.4V464c0 26.5 21.5 48 48 48H160V256zM480 512H592c26.5 0 48-21.5 48-48V372.4c0-17.5-9.5-33.6-24.9-42.1L480 256V512z"
                ></path></svg
              >
              <h3 class="small-title">Meet Us</h3>
              <p class="text-step--1">
                Lorem ipsum dolor sit amet consectetur adipisicing elit.
              </p>
            </a>
            <a href="/who-we-are/mission-and-beliefs" class="flow">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 640 512"
                width="32"
                height="32"
                fill="var(--color-primary-800)"
              >
                <defs
                  ><style>
                    .fa-secondary {
                      opacity: 0.4;
                    }
                  </style></defs
                ><path
                  class="fa-primary"
                  d="M278.8 .7c3.5 .8 6.9 2.1 10 4.1c7.5 4.6 12.4 11.9 14.3 19.9c1.1 4.6 1.2 9.4 .1 14.1c-.7 3.2-1.9 6.3-3.6 9.3L213.3 199.3c-3.5 6-5.3 12.9-5.3 19.8V304c0 8.8 7.2 16 16 16s16-7.2 16-16V224c0-17.7 14.3-32 32-32s32 14.3 32 32V342.2c0 58-39 108.7-95 123.7l-168.7 45c-9.6 2.6-19.9 .5-27.7-5.5S0 489.9 0 480V384c0-13.8 8.8-26 21.9-30.4l79.2-26.4c6.5-2.2 10.9-8.3 10.9-15.2V238.5c0-15.8 4.7-31.2 13.4-44.4L245.2 14.5c4.6-7.1 11.7-11.8 19.4-13.6c4.6-1.1 9.4-1.2 14.1-.1z"
                ></path><path
                  class="fa-secondary"
                  d="M361.2 .7c-3.5 .8-6.9 2.1-10 4.1c-7.5 4.6-12.4 11.9-14.3 19.9c-1.1 4.6-1.2 9.4-.1 14.1c.7 3.2 1.9 6.3 3.6 9.3l86.4 151.2c3.5 6 5.3 12.9 5.3 19.8V304c0 8.8-7.2 16-16 16s-16-7.2-16-16V224c0-17.7-14.3-32-32-32s-32 14.3-32 32V342.2c0 58 39 108.7 95 123.7l168.7 45c9.6 2.6 19.9 .5 27.7-5.5s12.5-15.4 12.5-25.4V384c0-13.8-8.8-26-21.9-30.4l-79.2-26.4c-6.5-2.2-10.9-8.3-10.9-15.2V238.5c0-15.8-4.7-31.2-13.4-44.4L394.8 14.5C390.1 7.4 383.1 2.7 375.4 .9c-4.6-1.1-9.4-1.2-14.1-.1z"
                ></path></svg
              >
              <h3 class="small-title">Our Beliefs</h3>
              <p class="text-step--1">
                Lorem ipsum dolor sit amet consectetur adipisicing elit.
              </p>
            </a>
            <a href="/who-we-are/our-history" class="flow">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 640 512"
                width="32"
                height="32"
                fill="var(--color-primary-800)"
                ><defs
                  ><style>
                    .fa-secondary {
                      opacity: 0.4;
                    }
                  </style></defs
                ><path
                  class="fa-primary"
                  d="M89.7 405.1L320 451.2l230.3-46.1c15-3 25.7-16.1 25.7-31.4V28.8l25.7-5.1C621.5 19.7 640 34.8 640 55V421.8c0 15.3-10.8 28.4-25.7 31.4L320 512 25.7 453.1C10.8 450.2 0 437 0 421.8V55C0 34.8 18.5 19.7 38.3 23.7L64 28.8v345c0 15.3 10.8 28.4 25.7 31.4z"
                ></path><path
                  class="fa-secondary"
                  d="M64 373.8c0 15.3 10.8 28.4 25.7 31.4L304 448V32L100.6 2.2C81.3-.7 64 14.3 64 33.8V373.8zM576 33.8c0-19.5-17.3-34.5-36.6-31.7L336 32V448l214.3-42.9c15-3 25.7-16.1 25.7-31.4V33.8z"
                ></path></svg
              >
              <h3 class="small-title">Our History</h3>
              <p class="text-step--1">
                Lorem ipsum dolor sit amet consectetur adipisicing elit.
              </p>
            </a> -->
          </div>
        </div>
        <div>
          <img
            src={urlFor(welcome.image).width(900).auto("format").url()}
            alt={welcome.image.asset.altText || ""}
            class="img"
            width={900}
            height={Math.floor(
              900 / welcome.image.asset.metadata.dimensions.aspectRatio
            )}
            loading="lazy"
            decoding="async"
          />
          <!-- <Picture
            src={welcomeCollage}
            alt=""
            widths={[600, 900, 1200]}
            sizes="100vw"
          /> -->
        </div>
      </div>
    </article>
    <section id="features" class="content-wrapper flow">
      <FeatureList features={features} />
    </section>
    <section id="events">
      <div class="">
        <EventsHome>
          <h2 slot="header" class="text-step-4">Upcoming Events</h2>
        </EventsHome>
      </div>
    </section>
    <CTA content={homeCta} />
    <section id="resources">
      <Slider
        heading={featuredResources.heading}
        description={featuredResources.description}
        slides={resources}
      />
      <div class="center-items">
        <Button href="/resources">See All Resources</Button>
      </div>
    </section>
  </main>

  <style>
    #welcome,
    #events,
    #resources {
      margin-block: var(--section-spacer);
    }

    #events {
      margin-block-end: 0;
    }

    #events {
      padding-block: var(--section-spacer-half);
      background: no-repeat left/contain url("/faded-facade.png");
    }

    #resources {
      margin-top: 4rem;
    }

    #resources .center-items {
      margin-top: 4rem;
    }

    #welcome .content-wrapper.with-sidebar {
      --sidebar-gap: 3rem;
      --sidebar-min-width: 34rem;
      align-items: center;
    }

    #features.flow {
      --flow-space: var(--space-3xl);
    }

    .meet-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.25rem;
      border-top: 1px solid var(--color-primary-200);
      margin-top: 2rem;
      padding-top: 1rem;
    }

    .meet-grid a {
      text-decoration: none;
      border-radius: var(--rounded-corners);
      padding: 0.75rem;
      transition: background-color 0.2s ease;
    }

    .meet-grid a:hover {
      background-color: var(--color-primary-100);
    }

    @media (max-width: 768px) {
      .meet-grid {
        grid-template-columns: 1fr;
      }

      #welcome,
      #events,
      #resources {
        margin-block: var(--section-spacer-half);
      }

      #events {
        margin-block-end: 0;
      }
    }
  </style>
</Layout>
